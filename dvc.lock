schema: '2.0'
stages:
  filter:
    cmd: "lyscripts data filter data/joined.csv data/filtered.csv --include-subsites
      C01 C02 C03 C04 C05 C06 C09 C10\n"
    deps:
    - path: data/joined.csv
      hash: md5
      md5: 711468c4027e6221a49568d80635e260
      size: 934594
    outs:
    - path: data/filtered.csv
      hash: md5
      md5: 611103c49a8a482b7302339fdebf0173
      size: 823891
  join:
    cmd: "lyscripts data join --inputs data/2021-usz-oropharynx.csv data/2021-clb-oropharynx.csv
      data/2023-clb-multisite.csv data/2023-isb-multisite.csv data/2023-hvh-oropharynx.csv
      --output data/joined.csv\n"
    deps:
    - path: data/2021-clb-oropharynx.csv
      hash: md5
      md5: d40c0a1ae967a6983d60a0a809cf3972
      size: 92742
    - path: data/2021-usz-oropharynx.csv
      hash: md5
      md5: 1b949c74081ac4b6224186ebbb9c90df
      size: 159482
    - path: data/2023-clb-multisite.csv
      hash: md5
      md5: 9d72ee96af2c51033a2fb0bb8551e318
      size: 123938
    - path: data/2023-hvh-oropharynx.csv
      hash: md5
      md5: a5be2bcb32619f901c48bd1d8a7bae8d
      size: 82567
    - path: data/2023-isb-multisite.csv
      hash: md5
      md5: 6135ac91c08b7518372488fb2e0f9b69
      size: 204322
    outs:
    - path: data/joined.csv
      hash: md5
      md5: 711468c4027e6221a49568d80635e260
      size: 934594
  enhance:
    cmd: "lyscripts data enhance data/filtered.csv data/enhanced.csv\n"
    deps:
    - path: data/filtered.csv
      hash: md5
      md5: 611103c49a8a482b7302339fdebf0173
      size: 823891
    params:
      params.yaml:
        modalities:
          CT:
          - 0.76
          - 0.81
          MRI:
          - 0.63
          - 0.81
          PET:
          - 0.86
          - 0.79
          FNA:
          - 0.98
          - 0.8
          diagnostic_consensus:
          - 0.86
          - 0.81
          pathology:
          - 1.0
          - 1.0
          pCT:
          - 0.86
          - 0.81
          max_llh:
          - 1.0
          - 1.0
    outs:
    - path: data/enhanced.csv
      hash: md5
      md5: 8ed98ad0206f0114124a8b7da30961c5
      size: 997595
  plot_prevalence_by_subsite:
    cmd: "python scripts/prevalence_by_subsite.py --input data/enhanced.csv --params
      params.yaml --output figures/prevalence_by_subsite.svg\n"
    deps:
    - path: data/enhanced.csv
      hash: md5
      md5: 8ed98ad0206f0114124a8b7da30961c5
      size: 997595
    - path: scripts/prevalence_by_subsite.py
      hash: md5
      md5: 752ad8126acd1376b66f1bc55a83125f
      size: 4005
    params:
      params.yaml:
        barplot_kwargs:
          width: 0.9
          zorder: 2
    outs:
    - path: figures/prevalence_by_subsite.svg
      hash: md5
      md5: c52663856fb1c7f083015b2c3d785196
      size: 43477
