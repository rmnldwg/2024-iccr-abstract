[
  {
    "objectID": "content/manuscript.html",
    "href": "content/manuscript.html",
    "title": "A mixture of hidden Markov models to predict the lymphatic spread in head and neck cancer depending on primary tumor location",
    "section": "",
    "text": "Head and neck squamous cell carcinomas (HNSCC) frequently spread through the lymphatic system (Lindberg 1972; Woolgar 1999). Current diagnostic imaging modalities are unable to detect microscopic lymph node metastases (Snyder et al. 2021; Strohl et al. 2021). To avoid nodal recurrences, large volumes in the neck, which are at risk of harbouring occult disease, are irradiated electively. Guidelines about which lymph node levels (LNLs) to irradiate (Biau et al. 2019) are currently not based on a patient’s individual risk, but on the overall prevalence of nodal disease as reported in the literature (Lindberg 1972; Woolgar 1999).\nTo personalize the prediction of the risk for occult disease, given a patient’s individual diagnosis, we published\n\nlarge, multi-centric data that reports per patient which LNLs were clinically/pathologically involved (Ludwig, Hoffmann, Pouymayou, Morand, et al. 2022; Ludwig et al. 2023).\n\nAnd, building on this work,\n\nan interpretable hidden Markov model (HMM), trained with this data, to predict the risk for occult nodal disease, given an individual patient’s diagnosis (Ludwig et al. 2021).\n\nSuch a personalized risk prediction may allow clinicians to safely reduce the elective clinical target volume (CTV-N) and thus reduce side-effects that degrade the patient’s quality of life (Batth, Caudell, and Chen 2014).\nHere, we extend the previous work by incorporating the primary tumor location (specified as ICD-10 code) into the model of lymphatic tumor progression, focusing on tumors in the oropharynx and the oral cavity. HNSCC patients with primary tumors at different subsites show different patterns of lymphatic spread (Lindberg 1972; Woolgar 1999). So far, this could be handled by training different models for broader categories of tumor locations, e.g. oropharynx and oral cavity tumors. However, this approach does not describe differences in lymphatic spread between different subsites within the oropharynx and oral cavity. To address this issue, we present an approach using mixtures of HMMs. The intuition is that the lymphatic spread of a tumor that lies anatomically at the boarder of oropharynx and oral cavity (e.g. tumors in the palate) may be described by a mixture of different models."
  },
  {
    "objectID": "content/manuscript.html#sec-hmm",
    "href": "content/manuscript.html#sec-hmm",
    "title": "A mixture of hidden Markov models to predict the lymphatic spread in head and neck cancer depending on primary tumor location",
    "section": "Hidden Markov Model for Lymphatic Progression",
    "text": "Hidden Markov Model for Lymphatic Progression\nA patient’s state of lymph node involvement \\(\\mathbf{X}[t]\\) evolves over discrete time steps \\(t\\). Let us enumerate all \\(2^V\\) possible states, representing all combinations of LNLs. In this paper, we consider ipsilateral LNLs I, II, III and IV, which amounts to 16 possible states. The HMM is specified by a transition matrix:\n\\[\n\\mathbf{A} = \\begin{pmatrix} A_{ij} \\end{pmatrix} = P \\left( \\mathbf{X}[t+1] = \\boldsymbol{\\xi}_j \\mid \\mathbf{X}[t] = \\boldsymbol{\\xi}_i \\right)\n\\tag{2}\\]\nwhose elements \\(A_{ij}\\) contain the conditional probabilities that a state \\(\\mathbf{X}[t]=\\boldsymbol{\\xi}_i\\) transitions to \\(\\mathbf{X}[t+1]=\\boldsymbol{\\xi}_j\\) over one time step. The transition matrix is specified and parameterised via the graphical model shown in figure 1. The red arcs in the graph of figure 1 (right panel) are associated with the probability that the primary tumor spreads directly to a LNL (parameters \\(b_v\\)). The blue arcs describe the spread from an upstream LNL – given it is already metastatic – to a downstream level (parameters \\(t_{v \\rightarrow v+1}\\)).\nNow, let \\(\\boldsymbol{\\pi}\\) be the starting distribution\n\\[\n\\boldsymbol{\\pi} = \\begin{pmatrix} \\pi_i \\end{pmatrix} = P \\left( \\mathbf{X}[0] = \\boldsymbol{\\xi}_i \\right)\n\\tag{3}\\]\ndenoting the probability to start in state \\(\\boldsymbol{\\xi}_i\\) at time step 0. Assuming that every patient started with all LNLs being healthy, we set \\(\\pi_i\\) to zero for all states except the completly healthy state \\(\\boldsymbol{\\xi} = \\begin{pmatrix} 0, 0, 0, 0 \\end{pmatrix}\\), which has probability one.\nUsing the quantities introduced so far, the probability \\(P \\left( \\mathbf{X}[t]=\\boldsymbol{\\xi}_i \\right)\\) to be in state \\(\\boldsymbol{\\theta}_i\\) in time step \\(t\\) can now be conveniently expressed as a matrix product:\n\\[\nP \\left( \\mathbf{X}[t]=\\boldsymbol{\\xi}_i \\right) = \\left( \\boldsymbol{\\pi} \\cdot \\mathbf{A}^t \\right)_i\n\\tag{4}\\]\nThis evolution implicitly marginalizes over all possible paths to arrive at state \\(\\boldsymbol{\\xi}_i\\) after \\(t\\) time-steps. Additionally, we must marginalize over the unknown time of diagnosis using a time-prior \\(P_T(t)\\). This finally defines the probability distribution over all states of lymph node involvement used in equation 1.\n\\[\nP \\left( \\mathbf{X}=\\boldsymbol{\\xi}_i \\mid \\boldsymbol{\\theta} \\right) = \\sum_{t=0}^{t_\\text{max}} P_T(t) \\left( \\boldsymbol{\\pi} \\cdot \\mathbf{A}^t \\right)_i\n\\tag{5}\\]\nwhere \\(\\boldsymbol{\\theta}=\\{ b_v, t_{v \\rightarrow v+1} \\}\\) denotes the set of all model parameters (7 in our case). Fortunately, the exact length and shape of this distribution has little impact as previously shown (Ludwig et al. 2021). We set \\(t_\\text{max}=\\) 10 and \\(P_\\text{early}(t)\\) to a binomial distribution with parameter 0.3. Further details on the HMM can be found in Ludwig et al. (2021).\n\n\n\n\n\n\nFigure 1: On the left: Anatomical sketch of the tumor subsites and correspsonding ICD-10 codes considered in this work. The subsite “other parts of mouth” (C06) was not drawn. On the right: Parametrized graphical model of the lymphatic network considering four LNLs. Blue nodes represent the hidden states of LNLs \\(X_v\\), while the red one is the tumor. Arcs represent possible routes of metastatic spread, associated with a probability."
  },
  {
    "objectID": "content/manuscript.html#sec-mixture-of-hmms",
    "href": "content/manuscript.html#sec-mixture-of-hmms",
    "title": "A mixture of hidden Markov models to predict the lymphatic spread in head and neck cancer depending on primary tumor location",
    "section": "Mixture of HMMs",
    "text": "Mixture of HMMs\nLet us now assume that primary tumors at different subsites have different patterns of lymphatic spread, corresponding to different model parameters \\(\\boldsymbol{\\theta}\\). Training a separate model for every possible subsite (ICD-10 code) would require a sufficiently large dataset for every tumor site. However, anatomically nearby locations are expected to show very similar patterns of LNL involvement. Therefore, we consider a mixture model.\nLet us assume that we have a dataset \\(\\mathbf{D}\\) that is specified via the number of patients \\(N_{is}\\) that were diagnosed in LNL involvement state \\(i\\) and had a primary tutor in subsite \\(s\\). Let us further assume that we want to describe this dataset using a mixture of \\(M\\) HMMs, each with a different set of model parameters \\(\\boldsymbol{\\theta_m}\\). As the generative model of the data, we assume that a patient with subsite \\(s\\) is generated with probability \\(\\pi_{sm}\\) from model \\(m\\). The likelihood of the dataset can then be written as\n\\[\nP \\left( \\mathbf{D} \\mid \\boldsymbol{\\theta}, \\boldsymbol{\\pi}\\right) = \\prod_s \\prod_i \\left[ \\sum_{m=1}^M \\pi_{sm} P_m \\left( \\mathbf{X}=\\boldsymbol{\\xi}_i \\mid \\boldsymbol{\\theta}_m \\right) \\right]^{N_{is}}\n\\tag{6}\\]\nWe now have two types of parameters, the probabilities of tumor spread for the different models, \\(\\boldsymbol{\\theta_m}\\), and the mixing coefficients \\(\\pi_{sm}\\). Assuming a uniform prior in the interval \\([0,1]\\) for all parameters, the posterior distribution over the parameters \\(P \\left( \\boldsymbol{\\theta}, \\boldsymbol{\\pi} \\mid \\mathbf{D} \\right)\\) is given by the likelihood in equation 6 except for a normalisation constant. In this work, we use Markov chain Monte Carlo sampling (MCMC) via the emcee Python package (Foreman-Mackey et al. 2013) to sample model parameters from the posterior distribution. However, \\(P \\left( \\boldsymbol{\\theta}, \\boldsymbol{\\pi} \\mid \\mathbf{D} \\right)\\) itself is a multi-model distribution because one can permute the different models. To address this problem, we revert to an expectation-maximization (EM) algorithm where we iterate two steps until convergence of the mixing coefficients. In the E-step, we sample model parameters \\(\\boldsymbol{\\theta_m}\\) using MCMC for given mixing coefficients \\(\\pi_{sm}\\). In the M-step, we maximize the likelihood with respect to the mixing coefficients for given samples of \\(\\boldsymbol{\\theta_m}\\)"
  },
  {
    "objectID": "content/manuscript.html#multi-centric-data",
    "href": "content/manuscript.html#multi-centric-data",
    "title": "A mixture of hidden Markov models to predict the lymphatic spread in head and neck cancer depending on primary tumor location",
    "section": "Multi-Centric Data",
    "text": "Multi-Centric Data\nFor the analyses in this work, we used five datasets from four different institutions, resulting in 1242 patients in total.\n\n287 oropharyngeal patients from the University of Zurich in Switzerland\n263 oropharyngeal patients from the Centre Léon Bérard in France\n289 oropharyngeal and oral cavity patients from the Inselspital Bern in Switzerland\n239 oropharyngeal and oral cavity patients from the Centre Léon Bérard in France\n162 oropharyngeal patients from the Hospital Vall d’Hebron in Spain (not yet public)\n\n\n\n\n\n\n\nFigure 2: Prevalence of ipsilateral LNL involvement stratified by subsite. The subsites are sorted in ascending order by their prevalence of involvement in LNL II. Oral cavity subsites are plotted in shades of blue, oropharynx subsites in shades of orange.\n\n\n\nThe data sets 1-4 are publicly available in the form of CSV tables (Ludwig, Hoffmann, Pouymayou, Däppen, et al. 2022; Ludwig et al. 2023) and may be interactively explored in our Lymphatic Progression eXplorer LyProX. For each patient, the primary tumor subsite is reported (among other patient and tumor characteristics) and each individual LNL is reported as metastatic or healthy, according to the available diagnostic modalities (in part pathology after neck dissection, otherwise clinical involvement).\nIn figure 2, we plot the prevalence of involvement in the four ipsilateral LNLs I, II, III, and IV stratified by the primary tumor’s subsite. The figure illustrates the variations in LNL involvement between subsites within the oral cavity and oropharynx categories. The number of patients for each subsite is indicated in figure 3."
  }
]